
<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    
<meta name="SiteName" content="智慧国际机场"/>
<meta name="SiteIDCode" content="N000014366"/>
<meta name="ColumnName" content="出发航班" />
<meta name="ColumnDescription" content=""/>
<meta name="ColumnKeywords" content=""/>
<meta name="ColumnType" content=""/>

<meta name="others" content="页面生成时间 2022-08-19 17:30:53" />
<title>
    出发航班-智慧国际机场
    </title>
    <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1" name="viewport" />
    <link rel="stylesheet" href="/sfsairport/xhtml/css/common.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="/sfsairport/xhtml/css/swiper.min.css" />
    <link rel="stylesheet" href="/sfsairport/xhtml/css/aos.css" />
    <link rel="stylesheet" href="/sfsairport/xhtml/./layui/css/layui.css" />
    <link rel="stylesheet" href="/sfsairport/xhtml/css/layui-theme-custom.css" />
    <link rel="stylesheet" href="/sfsairport/xhtml/css/jquery.mmenu.all.css" />
    <link rel="stylesheet" href="/sfsairport/xhtml/css/jquery.mCustomScrollbar.css" />
    <link rel="stylesheet" href="/sfsairport/xhtml/css/jquery.running.css" />
    <link rel="stylesheet" href="/sfsairport/xhtml/css/newcss.css" />
    <link rel="stylesheet" href="/sfsairport/xhtml/css/xunpan.css" />
    <link rel="stylesheet" href="/sfsairport/xhtml/css/style.css" />
    <link rel="stylesheet" href="/sfsairport/xhtml/css/others.css" />
    <link rel="stylesheet" href="/sfsairport/button/button.css">
    <script type="text/javascript" src="/sfsairport/xhtml/js/jquery.min.js"></script>
    <script type="text/javascript" src="/sfsairport/xhtml/js/swiper.min.js"></script>
    <script type="text/javascript" src="/sfsairport/xhtml/js/layer/layer.js"></script>
    <script type="text/javascript" src="/sfsairport/xhtml/js/imagesloaded.pkgd.min.js"></script>
    <script type="text/javascript" src="/sfsairport/xhtml/js/jquery.mmenu.min.all.js"></script>
    <script type="text/javascript" src="/sfsairport/xhtml/js/jquery.running.min.js"></script>
    <meta name="siteCode" content="sfsairport">
    <script src="/sfsairport/xhtml/js/common.js"></script>
    <!-- <script src="/sfsairport/xhtml/js/airline.js"></script> -->
    <script type="text/javascript" >
        $(function(){
            var _code = "hbxx";
            $("#ej-nav li").each(function(){
                if($(this).attr("data-code") === _code){
                    $(this).addClass("cur");
                }
            })
        })
    </script>
    <style>
        .buttonGuanzhu{
            background-color: #3c4fe0;
            margin-top: 10px;
            width: 50px;
            height: 30px;
            display: flex;
        }

        #notificationBox {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            padding: 10px;
            background-color: #f2f2f2;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
            display: none;
            text-align: center;
        }

       

        .center-notification {
            position: fixed;
            top: 0;
            left: 0;
            width: 150px;
            height:30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>

<body>
    <div id="page">
        <header class="header">
            <script type="text/javascript" src="/sfsairport/xhtml/./layui/layui.js"></script>
<div class="header-top inner-20">
    <div class="m-width-1400 fixed">
        <div class="left-text fixed">
            <div class="scoll-text">
                <div class="swiper-container">
                    <div class="swiper-wrapper">
                    
                      <div class="swiper-slide">
                          <a>欢迎来到智慧航空管理系统,很高兴为您服务</a>
                      </div>

                     

                </div>
            </div>
            </div>
        </div>
        <div class="top-lx">
            该项目制作组：
            <a>
                吴承旭、马天扬、金俊河、张朋达、张志韩
            </a>
        </div>
    </div>
</div>
<!-- top--end -->
<div class="header-box m-width-1400 fixed">
    <div class="inner-20">
        <div class="logo">
            <a href="/sfsairport/index.html">
                <!-- <img src="/sfsairport/xhtml/./images/logo.svg"> -->
                <img src="/sfsairport/xhtml/./images/layer-logo.png">
                <!--  -->
                <!-- <img src="/sfsairport/xhtml/./images/logo-ny.svg" class="wap-logo"> -->
                <img src="/sfsairport/xhtml/./images/layer-logo.png" class="wap-logo">
            </a>
        </div>
        <div class="hover-search">
            <div class="close-btn">
                <a id="sear-close" class="iconfont iconguanbi"></a>
            </div>
            
            <div class="search-head-form">
                <form action="/search4/s" method="post" name="form1" target="_blank" id="form1">
                <input placeholder="搜索" name="searchWord" type="text" id="searchWord" size="50"/>
                <button type="submit" name="button" id="button" value="">
                    <i class="iconfont iconsousuo"></i>
                </button>
                <input name="uc" type="hidden" id="uc" value="1" />
                <input name="siteCode" type="hidden" id="siteCode" size="50" value="N000014366" />
                <input name="column" type="hidden" id="siteCode" size="50" value="全部" />
                </form>
            </div>
            
            <!-- form--end -->
        </div>
        <!-- hover-search--end0 -->
        <div class="nav-right fixed">
            <div class="top-notice">
                <div class="typename"></div>
                
            </div>
        </div>
        <!-- nav-right--end -->
        <div class="pc-nav">
            <div class="nav">
                <ul class="fixed">
                    <li><a href="/sfsairport/index.html">首页</a></li>
                    <li><a href="/sfsairport/hbxx/Departure_Arrival.html"  target="_self">航班信息</a>
                        <div class="erji ">
                            <div class="erji-menu fixed">
                                <div class="tit">航班信息</div>
                                <dl>
                                    <dd>
                                        <a href="/sfsairport/hbxx/Departure_Arrival.html"><i class="iconfont icongengduo"></i>出发航班</a>
                                    </dd>
                                    
                                    <dd class="hidegp">
                                        <a href="/sfsairport/gp/Airlines.html"><i class="iconfont icongengduo"></i>购票</a>
                                    </dd>
                                    
                                </dl>
                            </div>
                        </div>
                    </li>
                    <li><a href="/sfsairport/tcczy/dlm_tt.html"  target="_self">停车管理</a>
                        <div class="erji ">
                            <div class="erji-menu fixed">
                                <div class="tit">停车管理</div>
                                <dl>
                                    
                                    <dd>
                                        <a href="/sfsairport/tcczy/dlm_tt.html"><i class="iconfont icongengduo"></i>停车场指引</a>
                                    </dd>
                                  
                                    
                                </dl>
                            </div>
                        </div>
                    </li>
                    <li class="hidejcbx"><a href="/sfsairport/jcbx/show-repair.html"  target="_self">机场报修</a>
                        <div class="erji ">
                            <div class="erji-menu fixed">
                                <div class="tit">机场报修</div>
                                <dl>
                                    
                                    <dd>
                                        <a href="/sfsairport/jcbx/show-repair.html"><i class="iconfont icongengduo"></i>显示报修信息</a>
                                    </dd>
                                    
                                    
                                </dl>
                            </div>
                        </div>
                    </li>
                    <li><a href="/sfsairport/msmk/Dining.html"  target="_self">机场商业</a>
                        <div class="erji ">
                            <div class="erji-menu fixed">
                                <div class="tit">机场商业</div>
                                <dl>
                                    <dd>
                                        <a href="/sfsairport/msmk/Dining.html"><i class="iconfont icongengduo"></i>美食每刻</a>
                                    </dd>
                                        
                                    
                                </dl>
                            </div>
                        </div>
                    </li>
                    <li class="hideyhsc"><a href="/sfsairport/yhsc/introduction.html"  target="_self">用户手册</a>
                        <div class="erji ">
                            <div class="erji-menu fixed">
                                <div class="tit">用户手册</div>
                                <dl>
                                    <dd>
                                        <a href="/sfsairport/yhsc/introduction.html"><i class="iconfont icongengduo"></i>用户手册</a>
                                    </dd>
                                        
                                    
                                </dl>
                            </div>
                        </div>
                    </li>
                    <li class="hidemy"><a href="/sfsairport/wd/gkgrzx/CustomerPersonalCenter.html"  target="_self">我的</a>
                        <div class="erji ">
                            <div class="erji-menu fixed">
                                <div class="tit">我的</div>
                                <dl>
                                    <dd class="hidegkgrzx">
                                        <a href="/sfsairport/wd/gkgrzx/CustomerPersonalCenter.html"><i class="iconfont icongengduo"></i>顾客个人中心</a>
                                    </dd>
                                    <dd class="hidesjgrzx">
                                        <a href="/sfsairport/wd/sjgrzx/shoperAdd.html"><i class="iconfont icongengduo"></i>商家个人中心</a>
                                    </dd>
                                    <dd class="hideglzgrzx">
                                        <a href="/sfsairport/wd/glygrzx/manager.html"><i class="iconfont icongengduo"></i>管理者个人中心</a>
                                    </dd>
                                    <dd class="hidehsgrzx">
                                        <a href="/sfsairport/wd/hsgrzx/Add.html"><i class="iconfont icongengduo"></i>航司个人中心</a>
                                    </dd>
                                    <dd class="hidegzrygrzx">
                                        <a href="/sfsairport/wd/gzrygrzx/new-repair.html"><i class="iconfont icongengduo"></i>工作人员个人中心</a>
                                    </dd>
                                </dl>
                            </div>
                        </div>
                    </li>
                    

                </ul>
                    
            </div>
        </div>
        <!--手机端导航按钮 start-->
        <a href="javascript:;" class="btn-nav">
            <span class="icon-bar top"></span>
            <span class="icon-bar middle"></span>
            <span class="icon-bar bottom"></span>
        </a>
        <div class="nav-box">
            <nav id="menuWapw">
                <ul class="fixed">
                    <li><span><a href="/sfsairport/index.html">首页</a></span></li>
                    <li class="cur">
                        <span><a href="/sfsairport/hbxx/Departure_Arrival.html"  target="_self">航班信息</a><em><i class="iconfont iconxiala"></i></em></span>

                        <ul>
                            <li><span>
                                <a href="/sfsairport/hbxx/Departure_Arrival.html"  target="_self">出发航班</a></span>
                            </li>
                            
                            <li class="hidegp"><span>
                                <a href="/sfsairport/gp/Airlines.html"  target="_self">购票</a></span>
                            </li>
                        </ul>
                   
                    </li>
                    <li>
                        <span><a href="/sfsairport/tcczy/dlm_tt.html"  target="_self">停车管理</a><em><i
                                    class="iconfont iconxiala"></i></em></span>
                        <ul>
                            
                            <li><span>
                                <a href="/sfsairport/tcczy/dlm_tt.html"  target="_self">停车场指引</a></span>
                            </li>
                           
                        </ul>
                    </li>
                    <li class="hidejcbx">
                        <span><a href="/sfsairport/jcbx/show-repair.html"  target="_self">机场报修</a><em><i
                                    class="iconfont iconxiala"></i></em></span>
                        <ul>
                            
                            <li><span>
                                <a href="/sfsairport/jcbx/show-repair.html"  target="_self">显示报修信息</a></span>
                            </li>
                            
                        </ul>
                    </li>
                    <li>
                        <span><a href="/sfsairport/msmk/Dining.html"  target="_self">机场商业</a><em><i
                                    class="iconfont iconxiala"></i></em></span>
                        <ul>
                            <li><span>
                                <a href="/sfsairport/msmk/Dining.html"  target="_self">美食每刻</a></span>
                            </li>
                             
                        </ul>
                    </li>
                    <li class="hideyhsc">
                        <span><a href="/sfsairport/yhsc/introduction.html"  target="_self">用户手册</a><em><i
                                    class="iconfont iconxiala"></i></em></span>
                        <ul>
                            <li><span>
                                <a href="/sfsairport/yhsc/introduction.html"  target="_self">用户手册</a></span>
                            </li>
                             
                        </ul>
                    </li>
                    <li class="hidemy">
                        <span><a href="/sfsairport/wd/gkgrzx/CustomerPersonalCenter.html"  target="_self">我的</a><em><i
                                    class="iconfont iconxiala"></i></em></span>
                        <ul>
                            <li class="hidegkgrzx"><span>
                                <a href="/sfsairport/wd/gkgrzx/CustomerPersonalCenter.html"  target="_self">顾客个人中心</a></span>
                            </li>
                            <li class="hidesjgrzx"><span>
                                <a href="/sfsairport/wd/sjgrzx/shoperAdd.html"  target="_self">商家个人中心</a></span>
                            </li>
                            <li class="hideglzgrzx"><span>
                                <a href="/sfsairport/wd/glygrzx/manager.html"  target="_self">管理者个人中心</a></span>
                            </li>
                            <li class="hidehsgrzx"><span>
                                <a href="/sfsairport/wd/hsgrzx/Add.html"  target="_self">航司个人中心</a></span>
                            </li>
                            <li class="hidegzrygrzx"><span>
                                <a href="/sfsairport/wd/gzrygrzx/new-repair.html"  target="_self">工作人员个人中心</a></span>
                            </li>
                        </ul>
                    </li>
                    
                    
                   
                </ul>
            </nav>
                <!-- <div class="wap-top-lx">
                <i class="iconfont iconicon-kefu"></i>24小时服务热线：
                <a href="tel:0755-23456789">
                    0755-23456789
                </a>
            </div> -->
        </div>
        <!--手机端导航按钮 end-->
    </div>
</div> 
        </header>
        <!--首页banner start-->
        <div class="banner banner-ny">
            <img src="/sfsairport/xhtml/./images/flight-banner.jpg" />
            <div class="ny-banner-content m-width-1400">
                <div class="text">
                    <span>航班信息</span>
                    <br>
                    <h1>出发航班</h1>
                </div>
            </div>
        </div>
        <!--首页banner end-->
        <section class="main">
            <div class="main-box">
                <div class="flight-tab-item inner-20">
                    <ul class="m-width-1400 fixed" id="ej-nav">
                        <li data-code="hbxx">
                            <a href="/sfsairport/hbxx/Departure_Arrival.html">
                                <i class="iconfont iconqifei"></i>
                                <span>出发航班</span>
                            </a>
                        </li>
                        
                        <li data-code="gp" class="hidegp">
                            <a href="/sfsairport/gp/Airlines.html">
                                <i class="iconfont iconhangkonggongsi"></i>
                                <span>购票</span>
                            </a>

                        </li>
                    </ul>
                </div>
                <!-- flight-tab-item--end -->
                <div class="inner-20" id="app">
                    <div class="m-width-1400">
                        <div class="filter-grid fixed layui-form" lay-filter="airline">

                            <!-- <div class="filter-block date">
                                <i class="iconfont iconriqi"></i> -->
                                <!-- <i class="arrow"></i> -->
                                <!-- <div class="layui-input-block">
                                    <select name="interest" id="selectDateData" aria-placeholder="select" lay-filter='airline-select'>
                                      
                                    </select>
                                </div> -->
                            <!-- </div> -->
                            <!-- filter-block--end -->
                            <!-- <div class="filter-block time">
                                <i class="iconfont iconshijian"></i> -->
                                <!-- <i class="arrow"></i> -->
                                <!-- <div class="layui-input-block">
                                    <select class="select" id="dayTimeSelect"  name="daySelect">
                                        <option value="12" selected>All Time</option>
                                        <option value="0">00:00~01:59</option>
                                        <option value="1">02:00~03:59</option>
                                        <option value="2">04:00~05:59</option>
                                        <option value="3">06:00~07:59</option>
                                        <option value="4">08:00~09:59</option>
                                        <option value="5">10:00~11:59</option>
                                        <option value="6">12:00~13:59</option>
                                        <option value="7">14:00~15:59</option>
                                        <option value="8">16:00~17:59</option>
                                        <option value="9">18:00~19:59</option>
                                        <option value="10">20:00~21:59</option>
                                        <option value="11">22:00~23:59</option>
                                    </select>
                                </div>
                            </div> -->
                            <!-- filter-block--end -->
                            <div class="filter-block ser-title">
                                <i class="iconfont iconfeiji"></i>
                                <div class="layui-input-block">
                                    <input type="text" name="title" lay-verify="title" autocomplete="off"
                                        placeholder=" 请输入航班号/城市" class="layui-input" id="searchInfo" style="width: 1200px;">
                                    <button type="button" class="layui-btn" id="searchButton" style="left: 1220px; margin-top: 0px;">搜索</button>
                                    <div class="list-search">
                                        <div class="s-tab-content" style="max-height: 500px;overflow-y: scroll;">
                                            <div class="s-tab-block">
                                                <dl class="fzlist"></dl>
                                            </div>
                                        </div>                                        
                                   </div>
                                </div>
                            </div>
                            <!-- filter-block--end -->
                        </div>
                        <!-- filter--end -->
                        <div class="content-flight-table">
                            <div class="m-width-1400">
                                <div class="top-tab-item fixed">
                                    <!-- <div class="layui-input-inline">
                                        <input type="text" class="layui-input" id="centertime" placeholder="Select Time"
                                            readonly>
                                        <i class="arrow"></i>
                                    </div> -->
                                    <a id="prevFlight" href="javascript:;" class="tab-prev tab-btn">
                                        <i>←</i>较早航班
                                    </a>
                                    <a id="nextFlight" href="javascript:;" class="tab-next tab-btn">
                                        较晚航班<i>→</i>
                                    </a>
                                </div>
                                <!-- tab-item---end -->
                                <div class="flight-table">
                                    <div class="wap-tips" id="wap-tips">
                                        <div class="tips-con">
                                            <i class="iconfont iconshoushi_dianji"></i>
                                            <p>Swipe Left</p>
                                        </div>
                                    </div>
                                    <!-- wap-tips--end -->
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>日期</th>
                                                <th width="100">航班号</th>
                                                <th width="100">飞机类型</th>
                                                <th>价格</th>
                                                <th width="100">公司</th>
                                                <th>起飞时间</th>
                                                <th>到达时间</th>
                                                <th>登机口</th>
                                                <th>出发地</th>
                                                <th>目的地</th>
                                                <th>状态</th>
                                                <th>最晚购票时间</th>
                                                <th>剩余票数</th>
                                            </tr>
                                        </thead>
                                        <tbody id="cfbody">
                    
                                        </tbody>
                                    </table>
                                </div>
                                <!-- table--end -->
                            </div>
                            <!-- 1400--end -->
                            <!-- <div class="table-show-more">
                                <a href="javascript:;"><span>显示更多</span><i class="iconfont iconzhixiangshangshangjiantou"></i></a>
                            </div> -->
                        </div>
                        <!-- flight-table--end -->
                    </div>
                </div>
            </div>
            <!-- main--box -->
        </section>
        
        <div id="notificationBox" class="center-notification" style="display: none;">
            <p style="text-align: center"></p>
        </div>
    <script type="text/javascript" src="/sfsairport/xhtml/js/aos.js"></script>
    <script type="text/javascript" src="/sfsairport/xhtml/js/index.js"></script>
     <script type="text/javascript" src="/sfsairport/xhtml/./layui/layui.js"></script>
    
    <script>
        count = 0;
        type = window.localStorage.getItem('type')

        var prevFlightLink = document.getElementById('prevFlight');
        var nextFlightLink = document.getElementById('nextFlight');

        prevFlightLink.addEventListener('click', function() {
            // 使用选定日期作为参数调用renderData函数
            if(count > 0){
                count --;
            }else{
                // Show the notification box
                var notificationBox = document.getElementById('notificationBox');
                notificationBox.style.display = 'block';
                var notificationText = notificationBox.querySelector('p');
                    notificationText.textContent = '暂时没有更早的航班了'
                // Hide the notification box after 2 seconds
                setTimeout(function() {
                    notificationBox.style.display = 'none';
                }, 2000);
            }
            fetchFlightInfo();
        });

        nextFlightLink.addEventListener('click', function() {
            // 使用选定日期作为参数调用renderData函数
            count ++;
            fetchFlightInfo();
        });

        

        //日期转换
        function formatDate(dateStr) {
            // 解析日期字符串为日期对象
            var date = new Date(dateStr);

            // 获取年份
            var year = date.getFullYear();

            // 获取月份，并确保格式为两位数
            var month = (date.getMonth() + 1).toString().padStart(2, '0');

            // 获取日期，并确保格式为两位数
            var day = date.getDate().toString().padStart(2, '0');

            // 拼接为指定格式的日期字符串
            var formattedDateStr = year + '/' + month + '/' + day;

            return formattedDateStr;
        }
        function renderData(Data) {
            data = Data['flight_list']
            var dates = [];
            for (var i = 0; i < data.length; i++) {
                var takeoffDate = data[i].takeoff_date.split('-')[0];
                if (!dates.includes(takeoffDate)) {
                    dates.push(takeoffDate);
                }
            }
            for(var i=0;i<dates.length;i++){
                dates[i] = formatDate(dates[i])
            }
            dates.sort();
            console.log('所有日期:'+dates)
            data.sort((a, b) => {
                // Extract the takeoff_date and time from the string
                const [aDate, aTime] = a.takeoff_date.split('-');
                const [bDate, bTime] = b.takeoff_date.split('-');

                // Compare the dates first
                const dateComparison = aDate.localeCompare(bDate);
                if (dateComparison !== 0) {
                    return dateComparison;
                }

                // If the dates are the same, compare the times
                return aTime.localeCompare(bTime);
            });
            if(dates.length == count){
                count--;
                // Show the notification box
                var notificationBox = document.getElementById('notificationBox');
                notificationBox.style.display = 'block';
                var notificationText = notificationBox.querySelector('p');
                    notificationText.textContent = '暂时没有更晚的航班了'
                // Hide the notification box after 2 seconds
                setTimeout(function() {
                    notificationBox.style.display = 'none';
                }, 2000);
            }

            var tbody = document.getElementById('cfbody');
            tbody.innerHTML = '';

            
         

            console.log(data)
            console.log(typeof data)
            console.log(data.length)
            for (var i = 0; i < data.length; i++) {
                // var takeoffTime = formatTime(data[i].takeoff_date.split('-')[1]);
             
                // if(!isFlightInTimeRange(takeoff_time)){
                //     continue;
                // }

                var row = document.createElement('tr');
                

                var str = data[i].takeoff_date;
                var takeoff_date = str.split('-')[0];
                if(formatDate(takeoff_date) != dates[count]){
                    continue;
                }
                
                var flightDataCell = document.createElement('td');
                flightDataCell.textContent = takeoff_date;
                row.appendChild(flightDataCell);

                var flightNumberCell = document.createElement('td');
                flightNumberCell.textContent = data[i].flight_id;
                row.appendChild(flightNumberCell);

                var aircraftTypeCell = document.createElement('td');
                aircraftTypeCell.textContent = data[i].plane_type;
                row.appendChild(aircraftTypeCell);

                var priceCell = document.createElement('td');
                priceCell.textContent = data[i].price;
                row.appendChild(priceCell);

                var companyCell = document.createElement('td');
                companyCell.textContent = data[i].company_id;
                row.appendChild(companyCell);


                var takeoffDateCell = document.createElement('td');
                var str = data[i].takeoff_date;
                var takeoff_date = str.split('-')[0];
                var takeoff_time1 = str.split('-')[1];
                var takeoff_time = formatTime(takeoff_time1)
                takeoffDateCell.textContent = takeoff_time;
                takeoffDateCell.className = 'cell bold';
                row.appendChild(takeoffDateCell);

                var arriveDateCell = document.createElement('td');
                var str2 = data[i].arrive_date;
                var arrive_date = str2.split('-')[0];
                var arrive_time1 = str2.split('-')[1];
                var arrive_time = formatTime(arrive_time1)
                if(takeoff_date < arrive_date){
                    arriveDateCell.textContent = "次日"+arrive_time;
                }else{
                    arriveDateCell.textContent = arrive_time;
                }
                arriveDateCell.className = 'cell bold';
                row.appendChild(arriveDateCell);

                var portCell = document.createElement('td');
                portCell.textContent = data[i].port;
                row.appendChild(portCell);

                var departureCell = document.createElement('td');
                departureCell.textContent = data[i].departure;
                row.appendChild(departureCell);

                var destinationCell = document.createElement('td');
                destinationCell.textContent = data[i].destination;
                row.appendChild(destinationCell);

                var statusCell = document.createElement('td'); 
                statusCell.textContent = data[i].isArrive ? '已到达' : '未到达';
                if(statusCell.textContent == '已到达'){
                    statusCell.style.color = 'red'
                }else{
                    statusCell.textContent = data[i].isTakeoff ? '已起飞' : '未起飞';
                }
                row.appendChild(statusCell);

                var ddlCell = document.createElement('td');
                ddlCell.textContent = data[i].buy_ddl;
                row.appendChild(ddlCell);

                var availableTicketsCell = document.createElement('td');
                availableTicketsCell.textContent = data[i].avai_sites;
                row.appendChild(availableTicketsCell);

                //渲染关注按钮
                var buttonCell = document.createElement('td');
                var followButton = document.createElement('button');
                followButton.style.marginTop = '50px'
                followButton.className = 'custom-btn btn-7';
                followButton.innerHTML = '<span ">关注</span>';
                buttonCell.appendChild(followButton);
                row.appendChild(buttonCell);
                if(type != 'Pa'){
                    buttonCell.style.display='none'
                }else{
                    buttonCell.style.display='block'
                    buttonCell.style.marginTop='10px'
                }

                followButton.addEventListener('click', followFlight);


                row.setAttribute('data-takeoff',takeoff_time);


                tbody.appendChild(row);
            }
        }
        

        // Function to check if a given takeoff_time falls within the selected time range
        // function isFlightInTimeRange(takeoff_time) {
        //     // console.log('我进入时间判断函数啦')
        //     var selectElement = document.getElementById('dayTimeSelect');
        //     var selectedValue = selectElement.value;
        //     console.log('所选时间段为:'+selectedValue)
        //     if (selectedValue === '12') {
        //         return true; // All Time option selected, so all flights are included
        //     }
            
        //     // Get the lower and upper bounds of the selected time range
        //     var lowerBound = (parseInt(selectedValue) * 2) % 24;
        //     var upperBound = (lowerBound + 1) % 24;
            
        //     // Convert the takeoff_time to hours and minutes
        //     var timeParts = takeoff_time.split(":");
        //     var hour = parseInt(timeParts[0]);
        //     var minute = parseInt(timeParts[1]);
            
        //     // Check if the flight's takeoff_time falls within the selected time range
        //     if (hour >= lowerBound && hour < upperBound) {
        //         return true;
        //     }
            
        //     return false;
        // }

      

        function formatTime(time) {
            var timeParts = time.split(":");
            var hour = parseInt(timeParts[0]);
            var minute = parseInt(timeParts[1]);
            
            // 处理小时
            var formattedHour = hour < 10 ? "0" + hour : hour.toString();
            
            // 处理分钟
            var formattedMinute = minute < 10 ? "0" + minute : minute.toString();
            
            // 返回格式化后的时间字符串
            return formattedHour + ":" + formattedMinute;
        }



      //关注航班  
    function followFlight() {
        var flight_id = this.parentNode.parentNode.cells[1].textContent;
        // 在这里执行将航班添加到用户关注列表的操作
        console.log('关注航班：' + flight_id);
        token = window.localStorage.getItem("token")
        if(token == 'null'){
            alert('请登录!!!');
            window.location.href = '../index.html'
        }
        // 准备要发送的数据
        var data = {
            token: token,
            flight_id: flight_id
        };

        var xhr = new XMLHttpRequest();
        console.log(data);
        xhr.open("POST", "http://101.42.178.149/api/FlightInfo/subScribe", true);
        xhr.setRequestHeader("Content-Type", "application/json");
        console.log('发送中')
        console.log(xhr.readyState)
        xhr.onreadystatechange = function() {
            if (xhr.readyState === XMLHttpRequest.DONE) {
                if (xhr.status === 200) {
                // 请求成功
                var response = JSON.parse(xhr.responseText);
                if(response.msg != 1){
                    if(response.msg == "未登录"){
                        alert('未登录!!!');
                        return;
                        }else{
                            alert('您已关注此航班!!!')
                            return;
                        }
                    }
                    console.log(response); // 可以在控制台输出响应结果
                    alert('关注成功!!!')
                    // 在请求成功后，跳转到指定页面
                }else{
                    // 请求失败
                    console.error("请求失败");
                }
            }
        };

        xhr.send(JSON.stringify(data));
    }


window.onload = function(){
    var count = 0;
    fetchFlightInfo();
}


function fetchFlightInfo(){
    var xhr = new XMLHttpRequest();
        xhr.open('POST', 'http://101.42.178.149/api/FlightInfo/ShowFlight', true);
        xhr.onload = function() {
        if (xhr.status === 200) {
        var responseData = JSON.parse(xhr.responseText);
        // console.log(responseData)
        renderData(responseData);
        } else {
        console.error('Request failed. Status: ' + xhr.status);
        }
    };
    xhr.send();
}
          



            

    
        

        
       

        var searchButton = document.getElementById('searchButton');
        searchButton.addEventListener('click', function() {
            var searchInfo = document.getElementById('searchInfo').value;
            if(searchInfo == ""){
                console.log('我是null')
                return;
            }
            searchInfo=encodeURIComponent(searchInfo)
            console.log(searchInfo)
            var xhr = new XMLHttpRequest();
            xhr.open('POST', `http://101.42.178.149/api/FlightInfo/searchFlight`);
            xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded")
            xhr.onload = function() {
                if (xhr.status === 200) {
                var responseData = JSON.parse(xhr.responseText);
                // console.log(responseData)
                renderData(responseData);
                } else {
                console.error('Request failed. Status: ' + xhr.status);
                }
            };
            var params = 'searchInfo=' + searchInfo; // Create the parameter string
            xhr.send(params);
        });
    
        var searchInfo = document.getElementById('searchInfo')
        searchInfo.addEventListener('input',handleInputChange)
        function handleInputChange(event){
            value = event.target.value
            console.log('我在监听文本')
            if(value == ""){
                var xhr = new XMLHttpRequest();
                xhr.open('POST', 'http://101.42.178.149/api/FlightInfo/ShowFlight', true);
                xhr.onload = function() {
                    if (xhr.status === 200) {
                    var responseData = JSON.parse(xhr.responseText);
                    renderData(responseData);
                    } else {
                    console.error('Request failed. Status: ' + xhr.status);
                    }
                };
            xhr.send();
           
            }
        }

      $(function(){
        layui.use('form', function () {
            var form = layui.form;
            console.log( form);
          form.on('select(airline-select)',function(){	
			$.extend(window.airlineLoad,form.val("airline"))
			})
        })


        AOS.init({
            easing: 'ease-out-back',
            duration: 1000
        });
       });
      

		
    </script>
    <!-- footer and right fixed -->
    <footer class="footer inner-20">
        <div class="footer-box m-width-1400 fixed">
            <div class="flogo">
                <a href="/sfsairport/index.html" class="flogo-img">
                    <!-- <img src="/sfsairport/xhtml/./images/jtlogo.svg" /> -->
                    <img src="/sfsairport/xhtml/./images/layer-logo.png" />
                </a>
                <p>
                    <i class="iconfont icondianhua"></i>
                    <a href="tel:121-12112121">服务咨询热线：121-12112121</a>
                    <a href="tel:121-3211232222">服务投诉电话：121-3211232222</a>
                </p>
                <p> <i class="iconfont iconyouxiang"></i><a href="mailto:FWYX@zhihuihangban.com">服务投诉邮箱： FWYX@zhihuihangban.com</a></p>
            </div>
            <div class="foot-nav">
                <ul class="fixed">
                    <li>
                        <div class="z-code">
                    <h3><a href="javascript:;">关注我们</a></h3>
                    <div class="f-ewm">
                        <img src="/sfsairport/xhtml/./images/ewm.png"/>
                        <p>智慧机场发布<br>创作者团队</p>
                    </div>
                </div>
                <div class="z-code">
                    <h3><a>&nbsp;</a></h3>
                    <div class="f-ewm">
                        <img src="/sfsairport/xhtml/./images/iewm.png"/>
                        <p>后端高手</p>
                    </div>
                </div>
                    </li>
    
                    <li>
                        <h3><a href="javascript:;">客户服务</a></h3>
                        <dl>
                            <dd>
                                <a href="##"  target="_self">在线客服</a>
                            </dd>
                            <dd>
                                <a href="javascript:;" class="onlinemsg">意见反馈</a>
                            </dd>
                            <dd>
                                <a href="##"  target="_self">联系我们</a>
                            </dd>
                        </dl>
                    </li>
                    <li>
                        <h3><a href="##"  target="_self">我们的座右铭</a></h3>
                        <div class="line"></div>
                        <dl>
                            <dd>
                                <a href="##"  target="_self">德才兼备</a>
                            </dd>
                            <dd>
                                <a href="##"  target="_self">知行合一</a>
                            </dd>
                            <dd>
                                <a href="##"  target="_self">究天人之际</a>
                            </dd>
                            <dd>
                                <a href="##"  target="_self">通内外之变</a>
                            </dd>
                            <dd>
                                <a href="##"  target="_self">行一家之航</a>
                            </dd>
                            <dd>
                                <a href="##"  target="_self">竭尽服务</a>
                            </dd>
                            <dd>
                                <a href="##"  target="_self">一切为您</a>
                            </dd>
                        </dl>
                    </li>
                </ul>
            </div>
            <!-- nav--end -->
    
        </div>
        <!-- footer--box -->
        <div class="footer-copy  inner-20">
    
            
    
        </div>
        <!-- copy--end -->
    </footer>
<div class="right-fix">
    <!-- <a href="https://znkf-im.sfsairport.com/user-iframe.html?channel_key=0a7e572d89773315ca55ba49e8e035eb&init=1" class="kefu" target = "_blank">
        <i class="iconfont iconkefu"></i>
    </a> -->
    <a href="javascript:;" id="toTop">
        <i class="iconfont iconzhiding"></i>
    </a>
</div>
<!-- right-fix--end -->

<!-- 表单弹窗 -->
<div class="layer_notice">
<a class="layer-not-close layer-not-close1">
    <i class="iconfont iconguanbi1"></i>
</a>
<div class="tit"><img src="/sfsairport/xhtml/./images/layer-logo.png" /></div>
<h3>我们很高兴收到您的反馈！</h3>
<form class="layui-form"  action="/u/yjx/ajaxAdd" method="post">
    <!-- <div class="layui-form-item wrap">
        <label class="layui-form-label">反馈类型</label>
        <div class="layui-input-block">
            <select name="interest" lay-filter="aihao">
                <option value="0">提个建议</option>
                    <option value="1">提出建议1</option>
                    <option value="3">提出建议2</option>
                    <option value="4">提出建议3</option>
            </select>
        </div>
    </div> -->
    <div class="form-twoblock">
        <div class="layui-form-item youname">
            <label class="layui-form-label">您的名字<em class="error">*</em></label>
            <div class="layui-input-block">
                <input type="text" name="username" placeholder="" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item yousex">
            <label class="layui-form-label">性别</label>
            <div class="layui-input-block">
                <input type="radio" name="sex" value="女士" title="女士" checked="">
                <input type="radio" name="sex" value="先生" title="先生">

            </div>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">您的联系方式<em class="error">*</em></label>
        <div class="layui-input-block">
            <input type="text" lay-verify="Information" name="contact" placeholder="例如QQ、电子邮箱、手机号码" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">留言<em class="error">*</em></label>
        <div class="layui-input-block">
            <textarea type="text" name="content" class="layui-textarea"></textarea>
        </div>
    </div>
    <div class="layui-form-item">
        <div class="layui-input-block">
            <button type="reset" class="layui-btn layui-btn-primary close-lay-btn">取消</button>
            <button class="layui-btn" lay-submit="" lay-filter="formDemo">提交</button>
        </div>
    </div>
</form>

</div>
<!-- 表单提交成功以后的提示 -->
<div class="layer_notice_alert">
<a class="layer-not-close layer-not-close2">
    <i class="iconfont iconguanbi1"></i>
</a>
<div class="tit"><img src="/sfsairport/xhtml/./images/layer-logo.png" /></div>
<h3>感谢您提供反馈！</h3>
<p>我们非常感谢您的时间和努力，帮助我们更好地为您服务。</p>
<button class="layui-btn layer-not-close2">返回网站</button>
</div>

<script>



layui.use(['layer', 'form'], function () {
    var layer = layui.layer,
        form = layui.form;
    // $('.right-fix .kefu').click(function(){
    //     formWrite();
    // });
    $('.onlinemsg').click(function(){
        formWrite();
    });
    //表单弹窗
    var indexLayer=null;
    function formWrite(){
        indexLayer = layer.open({
            type: 1,
            shade: 0.6,
            closeBtn: 0,
            skin: 'notice-class',
            area: 'auto',
            maxWidth:800,
            title: false, //不显示标题
            content: $('.layer_notice'), //捕获的元素，注意：最好该指定的元素要存放在body最外层，否则可能被其它的相对元素所影响
            success: function (layero, index) {

            }
        });
    }

    //提交成功以后的弹窗
    var alertLayer=null;
    function formSuccess(){
        alertLayer = layer.open({
            type: 1,
            shade: 0.6,
            closeBtn: 0,
            skin: 'notice-class',
            area: ['auto'],
            maxWidth:800,
            title: false, //不显示标题
            content: $('.layer_notice_alert'), //捕获的元素，注意：最好该指定的元素要存放在body最外层，否则可能被其它的相对元素所影响
            success: function (layero, index) {

            }
        })
    }

    //自定义验证规则
    form.verify({
        Information: function(value){
            if(value.length < 5){
                return 'Information至少得2个字符';
            }
        }

    });
    //监听提交
    form.on('submit(formDemo)', function(data){

        data.field.token = window.localStorage.getItem('token')
        console.log(JSON.stringify(data.field),'最终的提交信息');
        layer.close(indexLayer);
        var jsonData = JSON.stringify(data.field)
      $.ajax({
        url:"http://101.42.178.149/api/extra/submitProblem",
        type:"post",
        data:jsonData,
        dataType:"json",
        success:function(data){console.log(data);}
      
      })
      
        formSuccess();
        return false;
    });
    //弹窗一的关闭效果
    $('.layer-not-close1,.close-lay-btn').click(function(){
        layer.close(indexLayer);
    });
    //弹窗二的关闭效果
    $('.layer-not-close2').click(function(){
        layer.close(alertLayer);
    });
});

</script>

<script type="text/javascript">
    //请配置domain 和 fullUrl 参数，user为test是本机测试环境，正式环境改为official,输出位置id为visitCount
    var visitConfig = {
            api : {
                test : '',
                official  : '/u/visit/count',
                use : 'official',
                domain : 'http://www.sfsairport.com',
                fullUrl: 'http://www.sfsairport.com/sfsairport/index.html',
                showId : 'fwl'
            }
    };
</script>
<script src="/u/res/skin/visits/count.js"></script>
<!-- <!-- <script src="/sfsairport/xhtml/js/sfsairport.js"></script> --> -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b6bc2190e8acb64154f3ec1c5c8a45b3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
    <!-- footer and right fixed end -->
    <!-- <script>
        
        // 在这里放置需要在页面加载完成后执行的代码
        var selectElement = document.getElementById('dayTimeSelect');
        console.log('选择框是:'+selectElement)
        console.log($('#dayTimeSelect').val())
        
        $("select[name='daySelect']").change(function(event){
            console.log('111111111111111111')
            alert('11111')
        })
        console.log('1111111111111:'+$._data($("#dayTimeSelect"), "events"))
    </script> -->
    <script src="/sfsairport/xhtml/js/type.js"></script>
</body>

</html>